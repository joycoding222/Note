# Chapter 4 网络编程

掌握：

1. 静态库动态库区别，如何使用；动态库加载失败
2. GDB 调试
3. 虚拟地址空间、文件描述符、系统API（通过man查看文档）

# 网络结构模式

## CS模式

## BS模式



# MAC 地址

**OSI 模型**

$$ \alpha $$



# IP 地址

A类：广域网

.255 一般做广播地址

32位二进制数，点分十进制

最大主机数减2

B类：城际网

C类：局域网

## 子网掩码

指明一个IP哪些位标识的是主机所在的子网，以及哪些位标识的是主机的位掩码；

子网掩码和IP地址按位与运算，得到网络IP

求主机IP:子网掩码按位取反，再和IP地址按位与运算

例子：
IP：192.168.10.10/24

最后的24表示子网掩码前24位是1(255.255.255.0)

# 端口

# 网络模型

## OSI七层参考模型

open system interconnection

物 数 网 传 会 表 应

1. 物理层

## TCP/IP四层模型

> `ping`测试跟另一台机器是否能够连通

# 协议

网络协议

常见协议：
应用层：补充ssh

## IP协议

TTL生存时间：最大的在网络中传递的次数（简单理解）



# 网络通信的过程

1. 封装，原主机从协议栈从上到下封装（加协议头）
2. 分用，目的主机从协议栈从下到上分用（解协议头）



ARP：获取目的MAC地址

广播发送，接受后解析



# Socket

## 字节序

大部分计算机是小端字节序

- big endian 
- little endian
- 字节序转换函数
- 网络字节序：大端

## 字节序转换

字节序转换函数是系统调用

网络字节序是大端字节序

## Socket地址

包括：端口号、IP地址

通用socket地址：`sockadddr`

专用socket地址：`sockaddr_in`



# IP 地址转换

字符串IP转换成整数

主机网络字节序转换

# TCP通信流程

TCP和UDP的区别：（都是传输层协议）
UDP（用户数据报协议）不可靠性体现在：

1. 无连接
2. 接收方收到数据后不会备份
3. 发送方不关心数据是否到达
4. 无拥塞控制

TCP（传输控制协议）：

1. 面向连接
2. 基于字节流
3. 仅支持单播（一对一）

# TCP 三次握手

采用三次握手建立连接，发生在connect()时

三次握手原因：
CS两端分别要确认客户端和服务器端的收发功能



TCP头：

ACK：标志位

ack：代表确认信号，和ACK不一样



# TCP通信并发

并发

并行



实现服务器并发：使用多线程、多进程